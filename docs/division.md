# 双人协同开发分工文档（防冲突）

> 两人均使用 Cursor 协同开发时，按本分工划分开发内容与文件归属，减少同时修改同一文件导致的冲突，并便于为各自 AI 划定工作范围。  
> 本项目为「易宿酒店预订平台 – 管理酒店信息 PC 端」，仅包含：登录/注册、酒店信息录入/编辑/修改、酒店信息审核/发布/下线列表。

---

## 一、分工总览


| 角色       | 负责模块           | 负责页面/能力                                             | 主要涉及目录与文件                                                                                                                                                                    |
| -------- | -------------- | --------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **同学 A** | 架构 + 登录注册 + 表单 | 项目初始化、登录/注册、酒店信息录入/编辑/修改、通用表单组件、用户/酒店类型与接口封装、全局错误拦截 | `src/App.tsx`、`src/router/`、`src/services/`、`src/types/`、`src/constants/`、`src/stores/`、`src/pages/Login`、`src/pages/Register`、`src/pages/HotelEdit`、`src/components/form/*` |
| **同学 B** | 审核列表 + 管理视图    | 酒店审核列表页、审核操作（通过/不通过/下线/恢复）、列表筛选与分页、审核状态展示、表格相关组件    | `src/pages/HotelReviewList`、`src/components/table/*`、`src/components/review/*`                                                                                               |


- **同学 A**：优先做「基础架构 + 登录注册 + 酒店信息表单」；不主动改审核列表页的业务逻辑与 UI。
- **同学 B**：在 A 搭好路由与 API 后，专注「审核列表页 + 审核流转」；不主动改 App 入口、路由结构、核心接口封装与类型定义。

（实际开发中，两人都可以写所有模块，只是为了减冲突，文档上给出“谁主负责哪块、谁先动手”的约束。）

---

## 二、文件归属（谁改谁、谁只读）

### 2.1 同学 A 负责（A 的 Cursor 主要改这些）


| 路径                                         | 说明                                        |
| ------------------------------------------ | ----------------------------------------- |
| `src/App.tsx`                              | 入口与整体路由容器，仅 A 修改                          |
| `src/router/*`                             | 路由配置（登录/注册/酒店编辑/审核列表）、鉴权路由守卫，仅 A 修改       |
| `src/services/request.ts`                  | Axios 实例、拦截器、全局错误处理，仅 A 修改                |
| `src/services/auth.ts`                     | 登录/注册/获取当前用户接口封装，仅 A 修改                   |
| `src/services/hotel.ts`                    | 酒店信息新增/编辑/详情接口封装，仅 A 修改                   |
| `src/types/*`                              | 用户、酒店、审核记录等所有接口/业务类型定义，仅 A 修改             |
| `src/constants/index.ts`                   | 角色枚举、审核状态枚举、分页大小等，仅 A 修改                  |
| `src/stores/authStore.ts` 或 `useAuthStore` | 登录态与当前用户信息，由 A 创建与维护；B 只按约定字段读写，不改结构/不重命名 |
| `src/stores/hotelStore.ts`                 | 正在编辑的酒店信息草稿等，由 A 维护；B 只在需要时读取，不改结构        |
| `src/pages/Login/*`                        | 登录页全量逻辑与 UI，仅 A 修改                        |
| `src/pages/Register/*`                     | 注册页全量逻辑与 UI，仅 A 修改                        |
| `src/pages/HotelEdit/*`                    | 酒店信息录入/编辑/修改页逻辑与 UI，仅 A 修改                |
| `src/components/form/*`                    | 通用表单组件（输入框封装、星级选择、价格输入、日期选择等），主要由 A 维护    |
| `docs/api.md`（如存在）                         | 接口文档，仅 A 修改                               |


### 2.2 同学 B 负责（B 的 Cursor 主要改这些）


| 路径                                    | 说明                                        |
| ------------------------------------- | ----------------------------------------- |
| `src/pages/HotelReviewList/*`         | 酒店审核/发布/下线列表页全量逻辑与 UI，仅 B 修改              |
| `src/components/table/HotelTable.tsx` | 列表表格组件，仅 B 修改                             |
| `src/components/review/ReviewActions` | 审核操作按钮组件（通过/不通过/下线/恢复），仅 B 修改             |
| `src/components/review/StatusTag`     | 审核状态展示组件，仅 B 修改                           |
| `src/components/review/FilterBar`     | 审核列表顶部筛选区域（按状态/关键字/商户等），仅 B 修改            |
| `src/components/common/Loading.tsx`   | 若为列表专用 Loading，由 B 创建与维护；若调整为全局通用与 A 协商归属 |
| `src/components/common/Empty.tsx`     | 若为审核列表专用空态，由 B 创建与维护；若调整为全局通用与 A 协商归属     |


### 2.3 共享/交叉时的规则


| 文件/目录                       | 归属      | 规则                                                  |
| --------------------------- | ------- | --------------------------------------------------- |
| `src/stores/authStore.ts`   | A 创建并维护 | B 可读可写（比如根据角色展示不同按钮），但**不**改字段名、结构、导出方式；新增字段需与 A 约定 |
| `src/stores/hotelStore.ts`  | A       | B 如需读取正在编辑的酒店信息，仅按约定字段读取，不修改结构                      |
| `src/router/*`              | A       | B 若需新路由（例如审核详情页），由 A 添加；B 只在页面内部用 `useNavigate` 等行为 |
| `src/services/*.ts`         | A       | B **只读不改**；若接口需增删字段，由 A 改，改完 B 再对接                  |
| `package.json`              | 谁加依赖谁改  | 加新依赖前在群里说一声，避免两人同时改；提交前确保已 `pull` 最新内容              |
| `README.md` / `docs/*`      | 可分块     | A 写「项目介绍、架构、运行方式、目录说明」；B 写「审核列表/审核流程说明」，合并时不覆盖对方段落  |
| `.eslintrc.*`、`.prettierrc` | 协商      | 建议由 A 统一改一次后固定规则，之后不频繁调整                            |


---

## 三、按周的任务拆分（对应实现计划）

假设从 1/29 开始，整体到 2/26 结束。

### 第 1 周（1/29 - 2/4）：项目骨架 + 三页占位

> 建议顺序：先 A 搭脚手架和基础，再由 B 在已存在的页面占位上填充逻辑。


| 任务                                                   | 负责人       | 说明                                                                                         |
| ---------------------------------------------------- | --------- | ------------------------------------------------------------------------------------------ |
| 1.1 初始化项目（Vite + React + TS + AntD 等）                | **A**     | 创建基础目录结构：`src/pages`、`src/components`、`src/services`、`src/stores` 等                        |
| 1.2 配置路由与基础布局                                       | **A**     | 在 `App.tsx`、`src/router` 中配置 Login / Register / HotelEdit / HotelReviewList 等基础路由和布局占位 |
| 1.3 封装 `request.ts`、`auth.ts`、`hotel.ts`                 | **A**     | 抽象 Axios 实例与通用请求封装，完成认证与酒店相关接口的基础封装（含请求/响应拦截和错误处理）          |
| 1.4 定义基础类型与常量                                       | **A**     | 在 `src/types`、`src/constants` 中定义 User、Hotel、ReviewStatus 等类型、枚举及通用常量               |
| 1.5 登录/注册页面骨架                                       | **A**     | 登录/注册页面结构与基本表单布局，包含角色选择占位，暂不接真实接口                                     |
| 1.6 酒店信息编辑页面骨架                                       | **B**     | 表单大致分区（基础信息、价格、房型等）占位                                                                      |
| 1.7 酒店审核列表页面骨架                                       | **B**     | 在 `HotelReviewList` 中实现表格占位、简单列定义                                                          |


**冲突预防**：  

- 第 1 周主要由 A 提交主干结构；B 在 A 提交路由与服务后再拉取，**只改 `HotelReviewList` 页和自己组件目录**。

---

### 第 2 周（2/5 - 2/11）：核心业务功能


| 任务                      | 负责人   | 说明                                           |
| ----------------------- | ----- | -------------------------------------------- |
| 2.1 登录/注册联调（含角色：商户/管理员） | **A** | 完成登录/注册接口，对接 `authStore`，登录后根据角色跳转不同页面       |
| 2.2 酒店信息录入/编辑/保存（商户视角）  | **A** | 表单字段校验、分区折叠、保存草稿/提交审核 按钮逻辑；使用 `hotel.ts` 接口  |
| 2.3 通用表单组件抽取            | **A** | 输入框封装、星级选择、价格输入、日期选择等，以便复用在后续其他页面            |
| 2.4 审核列表数据拉取与展示（管理员视角）  | **B** | 使用 `hotel.ts` 提供的审核列表接口，按状态展示（审核中/通过/不通过/下线） |
| 2.5 审核操作：通过/不通过（含原因）    | **B** | 点击审核按钮后弹出输入原因弹窗，调用审核接口，刷新列表                  |
| 2.6 发布/下线/恢复逻辑          | **B** | 按题目要求：下线不是删除，可恢复；列表中状态与按钮文案同步更新              |
| 2.7 列表筛选与分页             | **B** | 支持按状态/关键字/商户等筛选，分页或“加载更多”                    |


**冲突预防**：  

- A 不改 `HotelReviewList` 中的业务逻辑和 UI；  
- B 不改 `auth.ts`、`hotel.ts`、`types` 文件结构；接口有需求先和 A 约好，再由 A 改类型与服务。

---

### 第 3 周（2/12 - 2/18）：联调 + 体验优化


| 任务                     | 负责人       | 说明                                           |
| ---------------------- | --------- | -------------------------------------------- |
| 3.1 与真实/Mock 后端联调，统一字段 | **A**     | 根据服务端返回统一 `types`、`services` 与 `docs/api.md` |
| 3.2 不同角色登录体验打通         | **A + B** | 商户登录后进入酒店信息录入页；管理员登录后进入审核列表页                 |
| 3.3 审核状态流转全链路验证        | **A + B** | 从商户提交审核 → 管理员审核通过/不通过 → 发布/下线/恢复，全链路跑通       |
| 3.4 列表性能与交互优化          | **B**     | 分页优化、请求节流/防抖、Loading/Empty/Error 统一风格        |
| 3.5 全局错误提示与无权限跳转       | **A**     | 在 `request.ts` 中统一处理 401/403，必要时跳转登录或提示      |
| 3.6 表单体验优化（提示信息、禁用状态等） | **A**     | 保存/提交时按钮禁用、成功/失败提示、字段错误高亮等                   |


**冲突预防**：  

- 3.1、3.3 需要两人配合时，**先由 A 改好类型与服务，再由 B 拉取后调整列表逻辑**，避免同时动 `services` 文件。

---

### 第 4 周（2/19 - 2/26）：收尾与答辩


| 任务                          | 负责人                  | 说明                                       |
| --------------------------- | -------------------- | ---------------------------------------- |
| 4.1 全流程自测、修 Bug             | **A + B**            | 各自负责的页面优先由本人修；涉及对方文件时先沟通                 |
| 4.2 代码整理、ESLint/Prettier 统一 | **A** 登录/表单；**B** 列表 | 只改自己负责的 `pages` 与 `components`，避免互相覆盖    |
| 4.3 README 与 docs           | **A** 架构/运行；**B** 审核 | 可先各自写段落再合并，或由 A 统稿                       |
| 4.4 Git 提交与打 tag            | **A + B**            | 按小步提交原则，重要节点可打 tag（如 `v1.0-review-pass`） |
| 4.5 答辩准备                    | **A + B**            | A 负责登录/表单演示；B 负责审核列表与流程演示，两人共同讲技术亮点与分工情况 |


---

## 四、Git 与时间错峰协作约定

- **分支策略**：只使用一个 `main` 分支开发，不建 `develop` 与 feature 分支，符合本组实际做法。  
- **时间错峰**：约定大致时间段内只由一人进行开发和提交（例如白天 A 为主、晚上 B 为主，实际可灵活约定），另一人主要看代码和讨论方案。  
- **操作习惯**：
  - 每次开始写代码前先 `git pull`；  
  - 完成一个小功能就 `commit`，并尽快 `push`，让另一人能及时拉到最新；  
  - 如遇到冲突，优先保留该文件主要负责人的修改，另一人协同调整。

---

## 五、给 Cursor / AI 的约定（如何减少冲突）

### 5.1 同学 A 的 Cursor 使用建议

- **主要改动范围**：  
  - `src/App.tsx`  
  - `src/router/*`  
  - `src/services/*`  
  - `src/types/*`  
  - `src/constants/*`  
  - `src/stores/*`  
  - `src/pages/Login/*`、`src/pages/Register/*`、`src/pages/HotelEdit/*`  
  - `src/components/form/*`
- **不要主动改**：  
  - `src/pages/HotelReviewList/*`  
  - `src/components/table/*`、`src/components/review/*`
- **共享文件**：  
  - `authStore` / `hotelStore` 由 A 维护字段与结构；B 需要新增字段时，由人类和 A 沟通后再改。

### 5.2 同学 B 的 Cursor 使用建议

- **主要改动范围**：  
  - `src/pages/HotelReviewList/*`  
  - `src/components/table/*`  
  - `src/components/review/*`  
  - 列表/审核相关 Loading/Empty/Error 组件
- **不要主动改**：  
  - `src/App.tsx`、`src/router/*`  
  - `src/services/*`、`src/types/*`、`src/constants/*`  
  - `src/pages/Login/*`、`src/pages/Register/*`、`src/pages/HotelEdit/*`
- **只读不改**：  
  - `src/services/*.ts`、`src/types/*`。若接口或类型需调整，由 B 提需求，A 修改。

### 5.3 通用习惯

- **先拉后改**：每天或每个任务前先 `git pull`。  
- **小步提交**：完成一个清晰的子任务就提交一次，备注写清楚（如「feat: 完成审核通过/不通过操作」）。  
- **冲突时**：  
  - 若是登录/注册/表单相关文件，优先保留 A 的改动；  
  - 若是审核列表/表格/审核组件相关文件，优先保留 B 的改动；  
  - 拿不准时，先在群里说一声再改。

---

## 六、快速对照：我该改哪些文件？


| 若你是…     | 你可以改                                                                                                                                                                                                  | 你只读 / 只引用                                                                                         |
| -------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------- |
| **同学 A** | `src/App.tsx`、`src/router/*`、`src/services/*`、`src/types/*`、`src/constants/*`、`src/stores/*`、`src/pages/Login/*`、`src/pages/Register/*`、`src/pages/HotelEdit/*`、`src/components/form/*`、`docs/api.md` | `src/pages/HotelReviewList/*`、`src/components/table/*`、`src/components/review/*`（不主动改）            |
| **同学 B** | `src/pages/HotelReviewList/*`、`src/components/table/*`、`src/components/review/*`、审核相关 Loading/Empty/Error 组件                                                                                          | `src/App.tsx`、`src/router/*`、`src/services/*`、`src/types/*`、`src/constants/*`、登录/注册/酒店编辑相关页面与表单组件 |


按本分工执行，并让各自 Cursor 限定在上述范围内改动，再结合时间错峰（同一时间只由一人编码提交），可以最大程度避免双人同时改同一文件造成的冲突。